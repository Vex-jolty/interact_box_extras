#pragma once
#include "processes.hpp"
#include <wx/wx.h>
#include <json/json.h>
#include <wx/dateevt.h>
#include <tuple>
#include "exported.hpp"
#include "malware_date_settings/resources.h"
#include "malware_date_settings/widgets/data_edit_widget.hpp"

class MalwareDateFrame : public wxFrame {
	public:
		MalwareDateFrame();

	private:
		void parseSettings();
		void OnSave(wxCommandEvent &event);
		void OnExit(wxCommandEvent &event);
		void OnClose(wxCloseEvent &event);
		void OnChange(wxCommandEvent &event);
		void OnDateChange(wxDateEvent &event);
		void OnAddNewMalware(wxCommandEvent &event);
		void OnDeleted(wxCommandEvent &event);
		void promptUserIfModified();
		void setupParentPanel();
		void informChange();
		std::tuple<int, int, int> getIds(int index);
		Json::Value removeFromJsonSettings(int index);

		bool _hasSaved = false;
		bool _isModified = false;
		wxPanel *_parentPanel;
		wxBoxSizer *_parentSizer;
		wxBoxSizer *_scrollSizer;
		wxScrolledWindow *_scrollWindow;
};

class MalwareDateSettings : public wxApp {
	public:
		virtual bool OnInit();
		int OnExit();
};

enum {
	ID_SAVE = 500,
	ID_CLOSE,
	ID_ADD,
};
